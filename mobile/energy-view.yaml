title: Energy
type: sections
max_columns: 1
theme: Bubble
path: energy
icon: mdi:lightning-bolt
sections:
- type: grid
  cards:
    - type: custom:stack-in-card
      mode: horizontal
      card_mod:
        style: |
          ha-card {
            background: "rgb(92, 83, 103)";
            border-radius: 20px;
            padding: 10px 5px 10px 5px; 
            }
      cards:
        - type: custom:mushroom-chips-card
          card_mod:
            style: |
              ha-card {
                overflow: hidden !important;
              }
              ha-card > * {
                display: flex !important;
                flex-wrap: nowrap !important;
                overflow-x: auto !important;
                overflow-y: hidden !important;
                gap: 8px !important;
              }
              ha-card > * > * {
                flex-shrink: 0 !important;
              }
              /* More aggressive targeting */
              ha-card ::-webkit-scrollbar {
                height: 4px;
              }
              ha-card ::-webkit-scrollbar-track {
                background: transparent;
              }
              ha-card ::-webkit-scrollbar-thumb {
                background: rgba(255, 255, 255, 0.3);
                border-radius: 2px;
              }
              /* Try to target all possible chip containers */
              mushroom-chips,
              .chip-container,
              [class*="chip"] {
                display: flex !important;
                flex-wrap: nowrap !important;
                overflow-x: auto !important;
                overflow-y: hidden !important;
                width: 100% !important;
              }
              mushroom-chip,
              [class*="chip"]:not([class*="container"]) {
                flex-shrink: 0 !important;
                white-space: nowrap !important;
              }
          chips:
            - type: template
              content: Back
              tap_action:
                action: navigate
                navigation_path: /mobile-dash/mobile-home
              icon: mdi:chevron-left
              card_mod:
                style: |
                  :host {
                    zoom: 1.25 !important;
                    --chip-background: var(--background-color-2);
                  }
            - type: conditional
              conditions:
                - condition: state
                  entity: switch.bayberry_off_grid_operation
                  state: 'on'
              chip:
                type: entity
                entity: sensor.bayberry_charge
                icon: mdi:home-battery
                icon_color: red
                tap_action:
                  action: more-info
                card_mod:
                  style: |
                    :host {
                      zoom: 1.25 !important;
                      --chip-background: var(--background-color-2);
    - type: custom:expander-card
      expanded: false
      title-card-clickable: true
      title-card:
        type: custom:bubble-card
        card_type: separator
        name: Solar Forecast
        icon: mdi:solar-power
        rows: 0.75
        styles: |
          .bubble-name {
            font-size: 20px !important;  /* title */
            font-weight: bold !important;
          }
          .bubble-sub-button 
          {
            font-size: 20px !important;
            font-weight: 700 !important;
          }
          .bubble-line {
            background: var(--primary-text-color);
            opacity: 0.1;
          }
          .card-content {
            padding-top: 7px !important;
          }
      cards:
        - type: entities
          card_mod:
            style: |
              ha-card {
                /* increase all text inside this card */
                font-size: 16px;
              }
          entities:
            - entity: sensor.solcast_pv_forecast_forecast_today
              name: Solar Forecast Today
            - entity: sensor.solcast_pv_forecast_forecast_tomorrow
              name: Solar Forecast Tomorrow
            - entity: sensor.rear_solar_array
              name: Live Rear Solar Array Production
            - entity: sensor.front_solar_array
              name: Live Front Solar Array Production
    - type: custom:stack-in-card
      mode: vertical
      card_mod:
        style: |
          ha-card {
            background: var(--ha-card-background);
            border-radius: 20px;
            padding: 10;
          }
      cards:
        - type: custom:bubble-card
          card_type: separator
          name: Live Power Flow
          icon: mdi:flash
          rows: 0.75
          styles: |
            .bubble-name {
            font-size: 20px !important;  /* title */
            font-weight: bold !important;
            }
            .bubble-line {
            background: var(--primary-text-color);
            opacity: 0.1;
            }
            .card-content {
            padding-top: 10px !important;
            padding-left: 10px !important;
            }
    - !include: power-flow-card.yaml
    - type: custom:stack-in-card
      mode: vertical
      card_mod:
        style: |
          ha-card {
            background: var(--ha-card-background);
            border-radius: 20px;
            padding: 10;
          }
      cards:
        - type: custom:bubble-card
          card_type: separator
          name: Power (last 24 hrs)
          icon: mdi:flash
          rows: 0.75
          styles: |
            .bubble-name {
            font-size: 20px !important;  /* title */
            font-weight: bold !important;
            }
            .bubble-line {
            background: var(--primary-text-color);
            opacity: 0.1;
            }
            .card-content {
            padding-top: 10px !important;
            padding-left: 10px !important;
            }
        - type: history-graph
          entities:
            - entity: sensor.bayberry_site_power
              name: Grid
            - entity: sensor.bayberry_solar_power
              name: Solar
            - entity: sensor.bayberry_load_power
              name: Home
          hours_to_show: 24
header:
card:
  type: markdown
  content: |
    # <ha-icon icon="mdi:lightning-bolt"></ha-icon> Energy
layout: start
card_mod:
style: |
  .: |
    .badge-container ha-state-label-badge {
      --ha-label-badge-size: 58px;
      --ha-label-badge-font-size: 18px;
      --mdc-icon-size: 26px;
      border-radius: 28px;
      background: var(--secondary-background-color);
      color: var(--primary-text-color);
    }
badges_position: bottom
badges_wrap: wrap
badges: null
cards: []